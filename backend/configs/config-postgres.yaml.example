# PostgreSQL 数据库配置示例
server:
  port: "8080"
  mode: "release"  # debug, release, test
  read_timeout: 30
  write_timeout: 30
  idle_timeout: 120
  shutdown_timeout: 30

database:
  # 数据库类型设置为 postgres
  type: "postgres"
  
  # PostgreSQL 连接配置 (方法一: 使用单独参数 - 推荐)
  host: "localhost"
  port: 5432
  database: "kube_node_manager"
  username: "postgres"
  password: "your-password"
  ssl_mode: "disable"  # disable, require, verify-ca, verify-full
  
  # 或者使用完整 DSN (方法二: 如果使用 DSN，请注释掉上面的单独参数)
  # dsn: "host=localhost port=5432 user=postgres dbname=kube_node_manager sslmode=disable password=your-password"
  
  # 连接池配置 (PostgreSQL 专用)
  max_open_conns: 25    # 最大打开连接数
  max_idle_conns: 10    # 最大空闲连接数
  max_lifetime: 3600    # 连接最大生存时间 (秒)

jwt:
  secret: "your-jwt-secret-change-in-production"
  expire_time: 86400  # 24 hours

ldap:
  enabled: false

# 日志配置 (生产环境推荐)
logging:
  format: "json"      # 结构化日志格式
  level: "info"       # 日志级别
  structured: true    # 启用结构化日志

# 监控配置
monitoring:
  enabled: true
  path: "/metrics"

# 健康检查配置
health:
  enabled: true
  database_timeout: 5

# 微服务配置
microservice:
  service_name: "kube-node-manager"
  instance_id: ""
  register_interval: 30

# 常用的 PostgreSQL 配置示例:
#
# 1. 本地开发环境
#   database:
#     type: "postgres"
#     host: "localhost"
#     port: 5432
#     database: "kube_node_manager_dev"
#     username: "postgres"
#     password: "dev123"
#     ssl_mode: "disable"
#
# 2. Docker 环境
#   database:
#     type: "postgres"
#     host: "postgres"  # Docker 服务名
#     port: 5432
#     database: "kube_node_manager"
#     username: "postgres"
#     password: "docker123"
#     ssl_mode: "disable"
#
# 3. 生产环境 (启用 SSL)
#   database:
#     type: "postgres"
#     host: "db.example.com"
#     port: 5432
#     database: "kube_node_manager_prod"
#     username: "knm_user"
#     password: "secure-password"
#     ssl_mode: "require"
#     max_open_conns: 50
#     max_idle_conns: 20
#     max_lifetime: 7200
#
# 4. 使用环境变量
#   可以通过环境变量覆盖配置:
#   export DATABASE_HOST="postgres-server"
#   export DATABASE_PASSWORD="env-password"

# 自动化运维配置
automation:
  enabled: false  # 自动化功能主开关 (默认禁用)
  
  # Ansible 配置
  ansible:
    enabled: true
    binary_path: "/usr/bin/ansible-playbook"
    temp_dir: "/tmp/ansible-runs"
    timeout: 3600
    max_concurrent: 10
  
  # SSH 配置
  ssh:
    enabled: true
    timeout: 300
    max_concurrent: 50
    connection_pool_size: 20
    connection_timeout: 30
    keepalive_interval: 60
  
  # 脚本配置
  scripts:
    enabled: true
    temp_dir: "/tmp/scripts"
    max_script_size: 1048576
    execution_timeout: 600
  
  # 工作流配置
  workflows:
    enabled: true
    max_steps: 50
    step_timeout: 3600
    max_retries: 3
  
  # 安全配置
  security:
    encryption_key: ""  # 必须通过环境变量 AUTOMATION_ENCRYPTION_KEY 设置 (32字节)
    require_approval: false
    dangerous_commands:
      - "rm -rf /"
      - "rm -rf /*"
      - "dd if=/dev/zero"
      - "mkfs"
      - ":(){ :|:& };:"
      - "> /dev/sda"
      - "chmod -R 777 /"
    command_whitelist_mode: false
    command_whitelist: []

# 环境变量说明:
# - AUTOMATION_ENABLED=true          # 启用自动化功能
# - AUTOMATION_ENCRYPTION_KEY=xxx    # 加密密钥（必须32字节）
