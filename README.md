# Kubernetes èŠ‚ç‚¹ç®¡ç†å™¨

ä¸€ä¸ªç°ä»£åŒ–çš„ Kubernetes èŠ‚ç‚¹ç®¡ç†å¹³å°ï¼Œæ”¯æŒå¤šé›†ç¾¤ç®¡ç†ã€èŠ‚ç‚¹æ ‡ç­¾å’Œæ±¡ç‚¹æ“ä½œã€ç”¨æˆ·æƒé™ç®¡ç†ç­‰åŠŸèƒ½ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **å¤šé›†ç¾¤ç®¡ç†** - æ”¯æŒæ·»åŠ å’Œç®¡ç†å¤šä¸ª Kubernetes é›†ç¾¤
- **èŠ‚ç‚¹æ¦‚è§ˆ** - å®æ—¶æ˜¾ç¤ºèŠ‚ç‚¹çŠ¶æ€ã€è§’è‰²ã€èµ„æºä½¿ç”¨æƒ…å†µ
- **æ ‡ç­¾ç®¡ç†** - æ”¯æŒæ‰¹é‡æ·»åŠ /åˆ é™¤èŠ‚ç‚¹æ ‡ç­¾ï¼Œæä¾›æ ‡ç­¾æ¨¡æ¿åŠŸèƒ½
- **æ±¡ç‚¹ç®¡ç†** - æ”¯æŒæ‰¹é‡ç®¡ç†èŠ‚ç‚¹æ±¡ç‚¹ï¼ˆNoScheduleã€PreferNoScheduleã€NoExecuteï¼‰
- **ç”¨æˆ·ç®¡ç†** - åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ï¼ˆAdminã€Userã€Viewerï¼‰
- **LDAPé›†æˆ** - æ”¯æŒ LDAP è®¤è¯å’Œç”¨æˆ·åŒæ­¥
- **æ“ä½œå®¡è®¡** - å®Œæ•´çš„æ“ä½œæ—¥å¿—è®°å½•å’ŒæŸ¥è¯¢

### æŠ€æœ¯ç‰¹æ€§
- **å“åº”å¼è®¾è®¡** - æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨ç«¯è®¿é—®
- **å®æ—¶æœç´¢** - æ”¯æŒæŒ‰èŠ‚ç‚¹åç§°ã€æ ‡ç­¾ç­‰æ¡ä»¶æœç´¢è¿‡æ»¤
- **æ‰¹é‡æ“ä½œ** - æ”¯æŒæ‰¹é‡æ ‡ç­¾å’Œæ±¡ç‚¹ç®¡ç†
- **æƒé™æ§åˆ¶** - ç»†ç²’åº¦çš„æƒé™ç®¡ç†å’Œè®¿é—®æ§åˆ¶
- **å®¹å™¨åŒ–éƒ¨ç½²** - å®Œæ•´çš„ Docker å®¹å™¨åŒ–æ–¹æ¡ˆ

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **æ¡†æ¶**: Go + Gin
- **æ•°æ®åº“**: SQLite3
- **è®¤è¯**: JWT + LDAP
- **Kubernetes**: client-go

### å‰ç«¯
- **æ¡†æ¶**: Vue 3 + Composition API
- **UIç»„ä»¶**: Element Plus
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±**: Vue Router 4
- **æ„å»ºå·¥å…·**: Vite

### éƒ¨ç½²
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **åå‘ä»£ç†**: Nginx
- **å¥åº·æ£€æŸ¥**: å†…ç½®å¥åº·æ£€æŸ¥ç«¯ç‚¹

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Docker 20.0+
- Docker Compose 2.0+
- æœ‰æ•ˆçš„ Kubernetes é›†ç¾¤è®¿é—®æƒé™

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd kube-node-manager
```

### 2. é…ç½®ç¯å¢ƒå˜é‡
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®JWTå¯†é’¥ç­‰å‚æ•°
```

### 3. é…ç½® Kubernetes è®¿é—®
```bash
# ç¡®ä¿æœ‰æ­£ç¡®çš„ kubeconfig æ–‡ä»¶
mkdir -p ~/.kube
# å¤åˆ¶ä½ çš„ kubeconfig æ–‡ä»¶åˆ° ~/.kube/config
```

### 4. å¯åŠ¨æœåŠ¡
```bash
docker-compose up -d
```

### 5. è®¿é—®åº”ç”¨
- Webç•Œé¢: http://localhost:8080
- APIæ¥å£: http://localhost:8080/api/v1
- é»˜è®¤è´¦æˆ·: admin / admin123

## ğŸ“ é¡¹ç›®ç»“æ„

```
kube-node-manager/
â”œâ”€â”€ backend/                 # Goåç«¯
â”‚   â”œâ”€â”€ cmd/                # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ internal/           # å†…éƒ¨ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ handler/        # HTTPå¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ service/        # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ model/          # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ middleware/     # ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ config/         # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ pkg/                # å…¬å…±åŒ…
â”œâ”€â”€ frontend/               # Vue3å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/     # ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ views/          # é¡µé¢
â”‚   â”‚   â”œâ”€â”€ store/          # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ router/         # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ api/            # APIæœåŠ¡
â”‚   â””â”€â”€ public/
â”œâ”€â”€ Dockerfile              # å¤šé˜¶æ®µæ„å»º
â”œâ”€â”€ docker-compose.yml      # Dockerç¼–æ’
â”œâ”€â”€ .env.example           # ç¯å¢ƒå˜é‡æ¨¡æ¿
â””â”€â”€ README.md
```

## ğŸ”§ å¼€å‘æŒ‡å—

### åç«¯å¼€å‘

#### å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
cd backend
go mod tidy
go run cmd/main.go
```

#### è¿è¡Œæµ‹è¯•
```bash
go test ./...
```

### å‰ç«¯å¼€å‘

#### å®‰è£…ä¾èµ–
```bash
cd frontend
npm install
```

#### å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

#### æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```bash
npm run build
```

## ğŸ” æƒé™è¯´æ˜

### ç”¨æˆ·è§’è‰²
- **Adminï¼ˆç®¡ç†å‘˜ï¼‰**: æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼Œå¯ä»¥ç®¡ç†ç”¨æˆ·ã€é›†ç¾¤ã€èŠ‚ç‚¹
- **Userï¼ˆæ“ä½œå‘˜ï¼‰**: å¯ä»¥ç®¡ç†èŠ‚ç‚¹æ ‡ç­¾å’Œæ±¡ç‚¹ï¼ŒæŸ¥çœ‹æ‰€æœ‰ä¿¡æ¯
- **Viewerï¼ˆè§‚å¯Ÿè€…ï¼‰**: åªèƒ½æŸ¥çœ‹ä¿¡æ¯ï¼Œæ— æ³•è¿›è¡Œä»»ä½•ä¿®æ”¹æ“ä½œ

### APIæƒé™
- æ‰€æœ‰APIéƒ½éœ€è¦JWTè®¤è¯
- åŸºäºç”¨æˆ·è§’è‰²è¿›è¡Œæƒé™æ§åˆ¶
- ç®¡ç†å‘˜æ‰èƒ½è®¿é—®ç”¨æˆ·ç®¡ç†æ¥å£

## ğŸ”Œ LDAP é›†æˆ

æ”¯æŒ LDAP è®¤è¯ï¼Œé…ç½®ç¤ºä¾‹ï¼š

```yaml
ldap:
  enabled: true
  host: "ldap.example.com"
  port: 389
  base_dn: "dc=example,dc=com"
  user_filter: "(uid=%s)"
  admin_dn: "cn=admin,dc=example,dc=com"
  admin_pass: "admin_password"
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### å¥åº·æ£€æŸ¥
- åç«¯: `GET /api/v1/health`
- å‰ç«¯: `GET /health`

### æ—¥å¿—çº§åˆ«
- INFO: ä¸€èˆ¬æ“ä½œæ—¥å¿—
- WARNING: è­¦å‘Šä¿¡æ¯
- ERROR: é”™è¯¯ä¿¡æ¯

### å®¡è®¡æ—¥å¿—
æ‰€æœ‰å…³é”®æ“ä½œéƒ½ä¼šè®°å½•å®¡è®¡æ—¥å¿—ï¼ŒåŒ…æ‹¬ï¼š
- ç”¨æˆ·ç™»å½•/ç™»å‡º
- èŠ‚ç‚¹æ ‡ç­¾/æ±¡ç‚¹ä¿®æ”¹
- ç”¨æˆ·ç®¡ç†æ“ä½œ
- é›†ç¾¤é…ç½®å˜æ›´

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

### è®¤è¯å®‰å…¨
- JWT Token è®¤è¯
- Token è¿‡æœŸæ—¶é—´æ§åˆ¶
- åˆ·æ–°Tokenæœºåˆ¶

### æ•°æ®å®‰å…¨
- å¯†ç å“ˆå¸Œå­˜å‚¨
- æ•æ„Ÿä¿¡æ¯åŠ å¯†
- SQLæ³¨å…¥é˜²æŠ¤

### ç½‘ç»œå®‰å…¨
- HTTPS æ”¯æŒ
- CORS é…ç½®
- å®‰å…¨å¤´éƒ¨è®¾ç½®

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æ— æ³•è¿æ¥ Kubernetes é›†ç¾¤
- æ£€æŸ¥ kubeconfig æ–‡ä»¶æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ç½‘ç»œè¿æ¥
- éªŒè¯é›†ç¾¤å‡­æ®

#### 2. ç™»å½•å¤±è´¥
- æ£€æŸ¥ç”¨æˆ·åå¯†ç 
- ç¡®è®¤JWTå¯†é’¥é…ç½®
- æŸ¥çœ‹åç«¯æ—¥å¿—

#### 3. å‰ç«¯é¡µé¢æ— æ³•åŠ è½½
- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨
- ç¡®è®¤ä»£ç†é…ç½®
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f backend
docker-compose logs -f frontend
```

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

### æ›´æ–°åº”ç”¨
```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up --build -d
```

### æ•°æ®å¤‡ä»½
```bash
# å¤‡ä»½æ•°æ®åº“
cp data/kube-node-manager.db backup/kube-node-manager-$(date +%Y%m%d).db
```

### æ¸…ç†æ•°æ®
```bash
# åœæ­¢æœåŠ¡
docker-compose down

# æ¸…ç†æ•°æ®å·
docker-compose down -v
```

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦æƒ…è¯·å‚è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚

### è´¡çŒ®æ­¥éª¤
1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“ æ”¯æŒ

å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
- æäº¤ [Issue](issues)
- 
---

**æ³¨æ„**: è¯·åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¿®æ”¹é»˜è®¤å¯†ç å’ŒJWTå¯†é’¥ï¼